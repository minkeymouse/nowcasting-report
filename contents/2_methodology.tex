\section{결과 비교}
\label{sec:results}

\subsection{실험 설계}
\label{subsec:experimental_design}

\subsubsection{실험 셋업}

본 연구는 세 가지 대상 변수(KOEQUIPTE, KOWRCCNSE, KOIPALL.G)에 대해 네 가지 예측 모형(ARIMA, VAR, DFM, DDFM)을 비교함. 각 모형은 30개 예측 수평선(1일부터 30일까지)에서 평가되며, 각 수평선에 대한 지표는 계산된 후 모형-대상 조합별로 평균을 계산하여 최종 성능 지표로 사용됨. 데이터셋 세부사항과 모형 파라미터는 표~\ref{tab:dataset_params}에 요약되어 있음.

\input{tables/tab_dataset_params}

표~\ref{tab:dataset_params}에서 볼 수 있듯이, 각 대상 변수마다 평균 43개의 시계열이 사용되며, 훈련 기간은 1985-2019년, 나우캐스팅 기간은 2024-2025년임. ARIMA 모형은 차수 (1,1,1)을 사용하며, VAR 모형은 시차 1을 사용함. DFM 모형은 3개의 요인과 최대 5000회 반복을 사용하며, DDFM 모형은 64-32 레이어 구조, 2개의 요인, 100 에폭을 사용함.

이러한 설정은 다음과 같은 이유로 선택됨: (1) ARIMA (1,1,1)은 대부분의 시계열에 적합한 기본 차수임; (2) VAR 시차 1은 정보 기준에 따라 선택되며 계산 효율성을 고려함; (3) DFM 요인 수 3은 데이터 차원과 해석 가능성의 균형을 고려함; (4) DDFM의 64-32 레이어 구조는 복잡한 패턴 학습과 과적합 방지의 균형을 고려함.

\subsubsection{데이터 전처리}

데이터 전처리는 시계열별 변환(transformation), 결측치 처리(imputation), 표준화(standardization) 단계로 구성됨.

각 시계열은 설정 파일에서 지정된 변환 유형에 따라 전처리됨. 변환 유형은 다음과 같음: 'lin' (선형, 변환 없음), 'log' (로그 변환), 'chg' (변화율), 'ch1' (1차 차분), 'cha' (연간 변화율), 'pch' (백분율 변화), 'pc1' (1차 백분율 차분), 'pca' (주성분 분석). 대부분의 시계열은 'lin' 또는 'log' 변환을 사용하며, 이는 시계열의 특성에 따라 결정됨.

결측치 처리는 모형에 따라 다르게 적용됨. ARIMA 모형의 경우, 단변량 시계열이므로 결측치가 있는 행을 제거함. VAR 모형의 경우, 다변량 데이터이므로 forward-fill과 backward-fill을 순차적으로 적용하여 결측치를 보간함. DFM과 DDFM 모형의 경우, 전처리 파이프라인에서 각 시계열별로 지정된 imputation 방법(ffill, bfill, naive forecaster 등)을 적용함.

표준화는 모든 모형에서 훈련 데이터의 표준편차를 사용하여 수행됨. 이는 서로 다른 시계열 간의 규모 차이를 제거하여 공정한 비교를 가능하게 함. DFM과 DDFM의 경우, 전처리 파이프라인의 마지막 단계에서 StandardScaler를 적용하여 각 시계열을 평균 0, 표준편차 1로 변환함.

\subsubsection{데이터 품질 문제 및 시리즈 제거}

KOIPALL.G 대상 변수에 대한 DFM 모형 훈련 중 수치적 불안정성이 발견되었으며, 이는 다음과 같은 데이터 품질 문제로 인한 것으로 확인됨:

\textbf{높은 상관관계:} 일부 시계열 간 상관계수가 0.95를 초과하여 공분산 행렬이 특이행렬에 가까워지는 문제가 발생함. 구체적으로, KOIPCHXPG와 KOIPCOMPG 간 상관계수 0.97, KOIPCHXPG와 KOIPVECHG 간 상관계수 0.98, KOIPCHXPG와 KOEXPSCOH 간 상관계수 0.986, pmiall과 pmiout 간 상관계수 0.96이 관찰됨.

\textbf{극단적인 결측치:} 일부 시계열(pmiall, pmiout)은 91.3\%의 결측치를 보이며, 이는 유효 표본 크기를 크게 감소시켜 요인 적재 행렬 추정 시 수치적 불안정성을 야기함.

이러한 문제를 해결하기 위해, KOIPALL.G 실험 설정에서 다음 시리즈를 제거함: (1) pmiall과 pmiout (극단적인 결측치 및 높은 상관관계), (2) KOIPCOMPG와 KOIPVECHG (KOIPCHXPG와의 높은 상관관계), (3) KOEXPSCOH (KOIPCHXPG와의 높은 상관관계 0.986). KOIPCHXPG는 상관관계 네트워크에서 더 중심적인 위치를 차지하므로 유지함.

추가적으로, 모든 실험에서 수치적 안정성과 일관성을 위해 DFM 모형의 블록 구조를 단일 글로벌 블록(Block\_Global)으로 단순화하고, 요인 수를 3개로 통일함. DDFM 모형의 요인 수도 3개로 업데이트하여 DFM과 일관성을 유지함. 이 조정 후 DFM 모형의 수치적 안정성이 개선될 것으로 예상되며, 향후 재훈련 시 이를 검증할 예정임.

\subsubsection{예측 모형}

본 연구에서 사용하는 네 가지 예측 모형은 다음과 같음:

\textbf{ARIMA 모형:} ARIMA(AutoRegressive Integrated Moving Average) 모형은 자기회귀 및 이동평균 성분을 포착하고 정상성을 위해 차분을 사용하는 단변량 시계열 예측 방법임. 모형 차수는 표준 시계열 분석 절차를 통해 결정됨.

\textbf{VAR 모형:} 벡터자기회귀(Vector Autoregression, VAR) 모형은 ARIMA를 다변량 설정으로 확장하여 여러 시계열 간의 동적 관계를 포착함. 시차 차수는 정보 기준에 따라 선택됨.

\textbf{동적요인모형 (DFM):} 동적요인모형(Dynamic Factor Model, DFM)은 많은 시계열에서 공통 요인을 추출하여 차원을 축소하고 혼합주기 데이터를 효과적으로 처리함 \cite{stock2002forecasting}. DFM은 다음과 같이 정의됨:

\begin{align}
x_t &= C z_t + \varepsilon_t, \quad \varepsilon_t \sim \mathcal{N}(0, R) \\
z_t &= A z_{t-1} + \eta_t, \quad \eta_t \sim \mathcal{N}(0, Q)
\end{align}

여기서 $x_t$는 관측된 시계열, $z_t$는 공통 요인, $C$는 요인 적재 행렬, $A$는 전이 행렬임. 파라미터는 EM 알고리즘을 통해 추정되며, 요인은 칼만 필터와 스무더를 사용하여 추정됨. 혼합주기 데이터 처리를 위해 텐트 커널(tent kernel) 집계 방법을 사용함 \cite{mariano2003new}. 이 방법은 집계 기간 중간에 가까운 관측값에 더 큰 가중치를 부여하여 서로 다른 주기의 데이터를 효과적으로 결합할 수 있게 함.

\textbf{심층 동적요인모형 (DDFM):} 심층 동적요인모형(Deep Dynamic Factor Model, DDFM)은 오토인코더 기반 아키텍처를 사용하여 복잡한 요인 구조를 학습함 \cite{andreini2020deep}. 비선형 인코더는 정교한 요인 관계 학습을 가능하게 하며, PyTorch Lightning을 사용하여 구현됨.

\subsubsection{Forecasting과 Nowcasting}

본 연구에서는 Forecasting과 Nowcasting을 구분하여 평가함.

\textbf{Forecasting:} Forecasting은 과거 데이터를 사용하여 미래 값을 예측하는 기법임. 본 연구에서는 각 모형-대상 조합에 대해 단일 모형을 훈련한 후, 해당 모형을 사용하여 모든 예측 수평선(1일부터 30일까지)에 대해 예측을 생성함. 즉, 각 모형은 한 번만 훈련되며, 동일한 훈련된 모형이 모든 수평선에 대해 예측에 사용됨. 각 수평선(1일, 2일, ..., 30일)에 대한 지표(sMSE, sMAE, sRMSE)를 계산한 후, 모형-대상 조합별로 1일부터 30일까지의 모든 수평선에 대해 평균을 계산하여 최종 성능 지표로 사용함. 이는 실제 운영 환경에서의 사용 패턴을 반영하며, 계산 효율성도 고려함.

평가는 단일 단계 예측 설계를 사용하며, 각 예측 수평선(1일부터 30일까지)은 단일 테스트 포인트를 사용하여 평가됨. 이 설계 선택은 통계적 신뢰성을 제한하지만 각 수평선에서 모형 성능에 대한 집중적인 평가를 제공함. 훈련-테스트 분할은 데이터의 80\%를 훈련에, 20\%를 테스트에 사용함.

\textbf{Nowcasting:} Nowcasting은 공식 통계가 발표되기 전에 현재 시점의 거시경제 변수를 추정하는 기법임. 본 연구에서는 모든 모형(ARIMA, VAR, DFM, DDFM)과 모든 대상 변수(3개)에 대해 Nowcasting 백테스트를 수행함. 훈련 기간은 1985년부터 2019년까지이며, Nowcasting 기간은 2024년 1월부터 2024년 12월까지(12개월)임. 

Nowcasting 실험은 다음과 같이 구성됨: 각 목표 월(2024-01 ~ 2024-12)에 대해 여러 시점에서 예측을 수행함. 구체적으로, 4주 전 시점과 1주 전 시점에서 예측을 수행하며, 각 시점의 view_date는 목표 월 말일에서 해당 주수를 뺀 값으로 계산됨(예: 4주 전 시점의 경우 view_date = target_month_end - 4 weeks). 각 시점에서 시리즈별 발표 시차(release date)를 기준으로 미발표 데이터를 NaN으로 마스킹함. 이는 실제 운영 환경에서 특정 시점에 사용 가능한 데이터만을 사용하여 예측하는 상황을 시뮬레이션함. 각 시점에서 1 horizon forecast를 생성하며, 시점별 예측 정확도를 비교함. 시간이 지날수록 더 많은 데이터를 사용할 수 있어 예측 정확도가 향상되는 패턴을 분석함.

\subsubsection{평가 지표}

나우캐스팅 성능은 표준화된 지표를 사용하여 평가되며, 이를 통해 서로 다른 시계열과 규모 간 공정한 비교가 가능함. 표준화된 평균제곱오차(sMSE), 표준화된 평균절대오차(sMAE), 표준화된 평균제곱근오차(sRMSE)를 보고하며, 표준화는 훈련 데이터의 표준편차를 사용하여 수행됨. 각 수평선에 대한 지표는 계산된 후, 모형-대상 조합별로 1일부터 30일까지의 모든 수평선에 대해 평균을 계산하여 최종 성능 지표로 사용됨.
