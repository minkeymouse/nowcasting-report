\section{방법론}
\label{sec:methodology}

\subsection{실험 설계}
\label{subsec:experimental_design}

\subsubsection{실험 셋업}

\begin{itemize}
    \item \textbf{대상 변수:} KOEQUIPTE, KOWRCCNSE, KOIPALL.G (3개)
    \item \textbf{모형:} ARIMA, VAR, DFM, DDFM (4개)
    \item \textbf{평가:} 22개 예측 기간(1--22개월), 모형-대상 조합별 평균 계산
\end{itemize}

\input{tables/tab_dataset_params}

\subsubsection{데이터 전처리}

\begin{itemize}
    \item \textbf{주간-월간 집계:} 주간 변수(7--10개)는 월말 평균으로 집계하여 월간 데이터로 변환함. 집계된 변수는 \texttt{\_agg} 접미사를 붙여 구분함 (예: A001 $\to$ A001\_agg). 이를 통해 모든 변수가 월간 주기로 통일됨.
    \item \textbf{변환:} 시계열별 변환 유형('lin', 'log', 'chg' 등) 적용
    \item \textbf{결측치 처리:} forward-fill $\to$ backward-fill $\to$ naive forecaster 순차 적용
    \item \textbf{표준화:}
    \begin{itemize}
        \item ARIMA/VAR: 원본 스케일 유지
        \item DFM/DDFM: StandardScaler 적용 (평균 0, 표준편차 1)
    \end{itemize}
\end{itemize}

\subsubsection{데이터 품질 문제 및 시리즈 제거}

데이터 품질 개선을 위해 다음 시리즈를 제거:
\begin{itemize}
    \item 높은 상관관계(> 0.95) 시리즈
    \item 극단적 결측치(91.3\%) 시리즈 (pmiall, pmiout)
    \item 블록 구조 단일 글로벌 블록으로 단순화, 요인 수 3개 통일
\end{itemize}

\subsubsection{예측 모형}

\textbf{ARIMA:} 자기회귀 및 이동평균 성분 포착, 정상성을 위해 차분 사용, 단변량 시계열 예측. 차수 (1,1,1) 사용.

\textbf{VAR:} ARIMA를 다변량으로 확장, 여러 시계열 간 동적 관계 포착. 시차 1 사용. 장기 예측에서 수치적 불안정성 발생 가능.

\textbf{DFM:} 많은 시계열에서 공통 요인 추출, 차원 축소, 혼합주기 데이터 처리 \cite{stock2002forecasting, banbura2012nowcasting}. DFM은 state-space 형태로 표현되며, measurement equation과 transition equation으로 구성됨. EM 알고리즘으로 파라미터 추정, 칼만 필터와 스무더로 요인 추정 \cite{bok2019frbny}. 칼만 필터는 실시간 데이터 흐름을 재귀적으로 처리하여 각 시점의 예측을 업데이트하며, 데이터의 품질과 시의성을 기반으로 가중치를 부여함. 이는 nowcasting에 특히 유용한 특성으로, 비동기적 데이터 발표와 결측치를 자연스럽게 처리할 수 있음 \cite{banbura2012nowcasting}.

\textbf{DDFM:} 오토인코더 기반 아키텍처로 비선형 요인 관계 학습 \cite{andreini2020deep}. DDFM은 인코더를 통해 관측 변수에서 잠재 요인을 추출하고, 디코더를 통해 요인에서 관측 변수로 재구성함. 이 과정에서 선형 DFM의 제약을 완화하여 더 복잡한 요인 구조를 학습할 수 있음. 대규모 데이터셋에서도 효과적으로 작동하며, 전통적인 DFM의 계산적 한계를 극복함.

본 연구에서는 DDFM의 성능 개선을 위해 다음과 같은 핵심 개선 사항을 적용함:
\begin{itemize}
    \item \textbf{대상 변수별 인코더 아키텍처:} KOEQUIPTE에 대해서는 기본 인코더([16, 4]) 대신 더 깊은 인코더([64, 32, 16])를 사용하고, 훈련 에포크를 150으로 증가시킴.
    \item \textbf{활성화 함수 선택:} KOEQUIPTE에 대해서는 기본 ReLU 대신 tanh 활성화 함수를 사용하여 음의 상관관계를 포착할 수 있도록 함.
    \item \textbf{Huber 손실 함수:} 이상치에 더 강건한 Huber 손실 함수를 지원함.
    \item \textbf{가중치 감쇠 (L2 정규화):} 선형 붕괴를 방지하기 위해 가중치 감쇠를 자동으로 적용함.
    \item \textbf{그래디언트 클리핑:} 훈련 안정성을 향상시키기 위해 그래디언트 클리핑을 지원함.
    \item \textbf{향상된 가중치 초기화:} 활성화 함수에 따라 적절한 가중치 초기화 방법을 적용함.
    \item \textbf{증가된 사전 훈련:} 사전 훈련 에포크 배수를 2로 증가시켜 비선형 특징 학습을 촉진함.
    \item \textbf{배치 크기 최적화:} 기본 배치 크기(100) 대신 더 작은 배치 크기(64)를 사용함.
    \item \textbf{DDFM 선형성 자동 감지 및 예측 품질 분석:} 선형 붕괴를 자동으로 감지하고 예측 품질을 분석하는 기능을 구현함.
\end{itemize}

\subsubsection{Forecasting과 Nowcasting}

\textbf{Forecasting:} 과거 데이터로 미래 값 예측. 각 모형 훈련 후 1--22개월에 대해 예측 생성.

\textbf{재귀적 예측 (ARIMA, VAR):} ARIMA와 VAR은 재귀적(recursive) 방식으로 다단계 예측을 수행함. 1-step ahead 예측값을 다음 단계의 입력으로 사용하여 순차적으로 예측을 생성하므로, 예측 오차가 누적되어 장기 예측에서 불안정성이 증가함.

\textbf{상태 업데이트 예측 (DFM, DDFM):} DFM과 DDFM은 state-space 구조를 활용하여 잠재 요인 상태를 업데이트한 후 직접 다단계 예측을 생성함 \cite{bok2019frbny}. 칼만 필터가 데이터를 재귀적으로 처리하여 예측을 업데이트하되, 각 예측 시점에서 요인의 품질과 시의성에 기반한 가중치를 부여하므로 오차 누적이 완화됨 \cite{banbura2012nowcasting}. 이러한 구조적 특성으로 인해 DFM/DDFM은 장기 예측에서 더 안정적인 성능을 보일 수 있음.

\textbf{Nowcasting:} 공식 통계 발표 전 현재 시점 거시경제 변수 추정 \cite{banbura2012nowcasting}. 각 목표 월에 대해 4주 전, 1주 전 시점에서 예측을 수행하며, 시리즈별 발표 시차(publication lag)를 기준으로 미발표 데이터를 마스킹함.
