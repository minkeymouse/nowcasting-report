\section{결과 비교}
\label{sec:results}

\subsection{실험 설계}
\label{subsec:experimental_design}

\subsubsection{실험 셋업}

본 연구는 세 가지 대상 변수(KOEQUIPTE, KOWRCCNSE, KOIPALL.G)에 대해 네 가지 예측 모형(ARIMA, VAR, DFM, DDFM)을 비교함. 각 모형은 22개 예측 수평선(1개월부터 22개월까지)에서 평가되며, 각 수평선에 대한 지표는 계산된 후 모형-대상 조합별로 평균을 계산하여 최종 성능 지표로 사용됨. 데이터셋 세부사항과 모형 파라미터는 표~\ref{tab:dataset_params}에 요약되어 있음.

\input{tables/tab_dataset_params}

표~\ref{tab:dataset_params}에서 볼 수 있듯이, 각 대상 변수마다 평균 43개의 시계열이 사용되며, 훈련 기간은 1985-2019년, 예측 및 나우캐스팅 기간은 2024-2025년임. 

\textbf{훈련 기간과 예측 기간 사이의 간격:} 본 연구에서는 훈련 기간(1985-2019)과 예측 기간(2024-2025) 사이에 약 4년의 간격이 존재함. 이는 다음과 같은 이유로 의도적으로 설계됨: (1) \textbf{COVID-19 시기 제외:} 2020-2023년 기간은 COVID-19 팬데믹으로 인한 경제 구조 변화와 비정상적인 패턴이 관찰되는 시기로, 이러한 외생적 충격을 훈련 데이터에 포함시키면 모형이 정상적인 경제 패턴을 학습하는 데 방해가 될 수 있음. 따라서 훈련 기간을 2019년까지로 제한하여 COVID-19 이전의 안정적인 경제 패턴만 학습하도록 함. (2) \textbf{데이터 누수 방지:} 훈련 기간과 예측 기간 사이에 명확한 간격을 두어 미래 정보가 훈련 과정에 누수되는 것을 방지함. 이는 모형의 실제 예측 성능을 공정하게 평가하기 위한 필수적인 설계임. (3) \textbf{구조 변화 검증:} COVID-19 이후 경제 구조 변화가 모형의 예측 성능에 미치는 영향을 평가할 수 있음.

ARIMA 모형은 차수 (1,1,1)을 사용하며, VAR 모형은 시차 1을 사용함. DFM 모형은 3개의 요인과 최대 5000회 반복을 사용하며, DDFM 모형은 64-32 레이어 구조, 3개의 요인, 100 에폭을 사용함.

DFM과 DDFM 모형의 설정은 다음과 같음: (1) 요인 수는 실험에서 3개로 통일됨; (2) 블록 구조는 단일 글로벌 블록(Block\_Global)만 사용하여 수치적 안정성과 일관성을 유지함; (3) 상태 공간 차원은 15차원(요인 3개 × 분기-월 집계를 위한 tent kernel 파라미터 5개)으로 설정됨. 이러한 설정은 대상 변수에 대해 동일하게 적용되어 공정한 비교를 수행함.

이러한 설정은 다음과 같은 이유로 선택됨: (1) ARIMA (1,1,1)은 많은 시계열에 적합한 기본 차수로 널리 사용됨; (2) VAR 시차 1은 정보 기준에 따라 선택되며 계산 효율성을 고려함; (3) DFM 요인 수 3은 데이터 차원과 해석 가능성의 균형을 고려함; (4) DDFM의 64-32 레이어 구조는 복잡한 패턴 학습과 과적합 방지의 균형을 고려함.

\subsubsection{데이터 전처리}

데이터 전처리는 시계열별 변환, 결측치 처리, 표준화 단계로 구성됨. 각 시계열은 설정 파일에서 지정된 변환 유형('lin', 'log', 'chg' 등)에 따라 전처리됨. 결측치는 forward-fill, backward-fill, naive forecaster를 순차적으로 적용하여 보간함. ARIMA와 VAR은 원본 스케일을 유지하고, DFM과 DDFM은 StandardScaler를 적용하여 각 시계열을 평균 0, 표준편차 1로 변환함.

\subsubsection{데이터 품질 문제 및 시리즈 제거}

KOIPALL.G 대상 변수에 대한 DFM 모형 훈련 중 수치적 불안정성이 관찰되어, 높은 상관관계(상관계수 > 0.95)를 보이는 시리즈와 극단적인 결측치(91.3\%)를 보이는 시리즈(pmiall, pmiout)를 제거함. 수치적 안정성을 위해 DFM과 DDFM 모형의 블록 구조를 단일 글로벌 블록으로 단순화하고, 요인 수를 3개로 통일함.

\subsubsection{예측 모형}

본 연구에서 사용하는 네 가지 예측 모형은 다음과 같음:

\textbf{ARIMA 모형:} ARIMA(AutoRegressive Integrated Moving Average) 모형은 자기회귀 및 이동평균 성분을 포착하고 정상성을 위해 차분을 사용하는 단변량 시계열 예측 방법임. 본 연구에서는 모형 차수 (1,1,1)을 사용함.

\textbf{VAR 모형:} 벡터자기회귀(Vector Autoregression, VAR) 모형은 ARIMA를 다변량 설정으로 확장하여 여러 시계열 간의 동적 관계를 포착함. 본 연구에서는 시차 1을 사용함. VAR 모형은 긴 예측 수평선에서 수치적 불안정성을 보일 수 있으며, 특히 horizon 1에서는 마지막 훈련 값을 그대로 예측하는 persistence 문제가 관찰될 수 있음. 이러한 문제를 해결하기 위해, 평가 코드에서 VAR-1의 비정상적으로 작은 오차 값(sMSE < 1e-6 또는 sMAE < 1e-4)을 감지하여 유효하지 않은 결과로 처리함.

\textbf{동적요인모형 (DFM):} 동적요인모형(Dynamic Factor Model, DFM)은 많은 시계열에서 공통 요인을 추출하여 차원을 축소하고 혼합주기 데이터를 처리함 \cite{stock2002forecasting}. DFM은 다음과 같이 정의됨:

\begin{align}
x_t &= C z_t + \varepsilon_t, \quad \varepsilon_t \sim \mathcal{N}(0, R) \\
z_t &= A z_{t-1} + \eta_t, \quad \eta_t \sim \mathcal{N}(0, Q)
\end{align}

여기서 $x_t$는 관측된 시계열, $z_t$는 공통 요인, $C$는 요인 적재 행렬, $A$는 전이 행렬임. 파라미터는 EM 알고리즘을 통해 추정되며, 요인은 칼만 필터와 스무더를 사용하여 추정됨. 혼합주기 데이터 처리를 위해 텐트 커널(tent kernel) 집계 방법을 사용함 \cite{mariano2003new}. 이 방법은 집계 기간 중간에 가까운 관측값에 더 큰 가중치를 부여하여 서로 다른 주기의 데이터를 결합함.

\textbf{심층 동적요인모형 (DDFM):} 심층 동적요인모형(Deep Dynamic Factor Model, DDFM)은 오토인코더 기반 아키텍처를 사용하여 복잡한 요인 구조를 학습함 \cite{andreini2020deep}. 비선형 인코더는 요인 관계 학습을 수행하며, PyTorch Lightning을 사용하여 구현됨.

\subsubsection{Forecasting과 Nowcasting}

Forecasting은 과거 데이터를 사용하여 미래 값을 예측하는 기법으로, 각 모형을 훈련한 후 1개월부터 22개월까지의 수평선에 대해 예측을 생성함. Nowcasting은 공식 통계 발표 전 현재 시점의 거시경제 변수를 추정하는 기법으로 \cite{banbura2012nowcasting}, 각 목표 월에 대해 4주 전과 1주 전 시점에서 시리즈별 발표 시차를 기준으로 미발표 데이터를 마스킹하여 예측을 수행함.

\subsubsection{평가 지표}

나우캐스팅 성능은 표준화된 지표를 사용하여 평가되며, 이를 통해 서로 다른 시계열과 규모 간 공정한 비교를 수행함. 표준화된 평균제곱오차(sMSE), 표준화된 평균절대오차(sMAE), 표준화된 평균제곱근오차(sRMSE)를 보고하며, 표준화는 훈련 데이터의 표준편차를 사용하여 수행됨. 각 수평선에 대한 지표는 계산된 후, 모형-대상 조합별로 1개월부터 22개월까지의 수평선에 대해 평균을 계산하여 최종 성능 지표로 사용됨.
