\subsubsection{Forecasting}

본 절에서는 세 가지 대상 변수(생산: KOIPALL.G, 투자: KOEQUIPTE, 소비: KOWRCCNSE)에 대한 네 가지 예측 모형(ARIMA, VAR, DFM, DDFM)의 예측 성능을 비교함. 실험은 1개월부터 22개월까지의 시점에 대해 수행되었으며, 표~\ref{tab:forecasting_results}에는 모든 시점(1-22개월)에 대한 평균값을 제시함. 

\textbf{실험 완료 상태:} 
\begin{itemize}
    \item \textbf{VAR:} 세 대상 변수 모두에서 22개 시점(1-22개월)에 대해 성공적으로 평가되었으며, 총 66개 결과 포인트(3개 대상 변수 × 22개 시점)를 생성함.
    \item \textbf{DFM:} 세 대상 변수 모두에서 평가되었으나, KOIPALL.G와 KOEQUIPTE에서는 22개월 시점의 결과가 누락되어(n\_valid=0) 21개 시점에 대한 결과만 사용 가능함. KOWRCCNSE에 대해서는 22개 시점에 대한 결과가 있음. 전체적으로 DFM은 64개 결과 포인트(21+21+22)를 생성함.
    \item \textbf{DDFM:} 세 대상 변수 모두에서 평가되었으나, KOIPALL.G와 KOEQUIPTE에서는 22개월 시점의 결과가 누락되어(n\_valid=0) 21개 시점에 대한 결과만 사용 가능함. KOWRCCNSE에 대해서는 22개 시점에 대한 결과가 있음. 전체적으로 DDFM은 64개 결과 포인트(21+21+22)를 생성함.
    \item \textbf{ARIMA:} 세 대상 변수 모두에서 유효한 결과(n\_valid=0)가 없어 평가에 실패함. 이는 ARIMA 모형의 예측 생성 과정에서 문제가 발생했을 가능성을 시사하며, 향후 연구에서 해결이 필요함.
\end{itemize}
전체 실험 결과 완전도는 약 73\% (194개 유효 결과 / 264개 전체 결과 포인트)임. 누락된 결과는 주로 ARIMA 모형의 평가 실패(66개 포인트)와 DFM/DDFM의 horizon 22 누락(4개 포인트)에 기인함.

표~\ref{tab:forecasting_results}는 모형별 타겟별로 모든 시점(1-22개월)에 대한 평균 표준화된 MAE와 MSE를 제시함. 각 셀은 해당 모형-타겟 조합의 평균 지표값을 나타내며, 각 지표에서 최소값(최고 성능)은 굵은 글씨로 표시됨. 상세한 시점별 결과는 부록에 제시됨.

\input{tables/tab_forecasting_results}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\textwidth]{images/forecast_vs_actual_koipall_g.png}
\caption{예측 대 실제: 전산업생산지수 (KOIPALL.G). 히스토리 기간(2023-01 to 2023-12)에는 실제값만 표시되며, 예측 기간(2024-01 to 2025-10)에는 실제값과 모형 예측값(VAR, DFM, DDFM)이 함께 표시됨. ARIMA는 유효한 결과가 없어 제외됨. 모든 값은 원본 데이터 스케일로 표시됨.}
\label{fig:forecast_vs_actual_koipallg}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\textwidth]{images/forecast_vs_actual_koequipte.png}
\caption{예측 대 실제: 설비투자지수 (KOEQUIPTE). 히스토리 기간(2023-01 to 2023-12)에는 실제값만 표시되며, 예측 기간(2024-01 to 2025-10)에는 실제값과 모형 예측값(VAR, DFM, DDFM)이 함께 표시됨. ARIMA는 유효한 결과가 없어 제외됨. 모든 값은 원본 데이터 스케일로 표시됨.}
\label{fig:forecast_vs_actual_koequipte}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\textwidth]{images/forecast_vs_actual_kowrccnse.png}
\caption{예측 대 실제: 도소매판매액 (KOWRCCNSE). 히스토리 기간(2023-01 to 2023-12)에는 실제값만 표시되며, 예측 기간(2024-01 to 2025-10)에는 실제값과 모형 예측값(VAR, DFM, DDFM)이 함께 표시됨. ARIMA는 유효한 결과가 없어 제외됨. 모든 값은 원본 데이터 스케일로 표시됨.}
\label{fig:forecast_vs_actual_kowrccnse}
\end{figure}

그림~\ref{fig:forecast_vs_actual_koipallg}, 그림~\ref{fig:forecast_vs_actual_koequipte}, 그림~\ref{fig:forecast_vs_actual_kowrccnse}는 각 대상 변수별로 히스토리 기간(2023-01 to 2023-12)과 예측 기간(2024-01 to 2025-10)의 실제 값 및 예측 값을 비교한 플롯임. 히스토리 기간에는 실제 값만 표시되며, 예측 기간에는 실제 값과 모형 예측값(VAR, DFM, DDFM)이 함께 표시됨. ARIMA는 유효한 결과가 없어 제외됨. 모든 값은 원본 데이터 스케일로 표시되며, X축은 월별 타임스탬프, Y축은 대상 변수 값임.

표~\ref{tab:forecasting_results}의 결과를 보면, VAR은 세 대상 변수 모두에서 성공적으로 평가되었으며, DFM과 DDFM도 세 대상 변수 모두에서 평가되었음. 각 모형은 대상 변수에 따라 매우 다른 성능 특성을 보임. 

\textbf{전체 시점 평균 성능 (표~\ref{tab:forecasting_results}):} KOIPALL.G에서는 DDFM이 가장 낮은 sMAE(0.6865, 21개 시점 평균)와 sMSE(0.61)를 보여 우수한 성능을 보임. VAR(sMAE=0.94, sMSE=1.11)도 양호한 성능을 보이며, DFM(sMAE=14.9689, sMSE=225.30)은 매우 높은 오차를 보여 KOIPALL.G에 대해서는 부적합함. KOEQUIPTE에서는 DFM과 DDFM이 거의 동일한 성능을 보이며(sMAE: DFM=1.1439, DDFM=1.1441, 평균 차이 0.000187, 21개 시점; sMSE: DFM=2.115, DDFM=2.115, 차이 0.0003), VAR(sMAE=1.37, sMSE=2.97)이 상대적으로 높은 오차를 보임. KOWRCCNSE에서는 VAR이 가장 낮은 sMAE(0.32)와 sMSE(0.20)를 보여 우수한 성능을 보이며, DDFM(sMAE=0.4961, sMSE=0.49)도 양호한 성능을 보임. DFM(sMAE=2.7848, sMSE=8.21)은 상대적으로 높은 오차를 보임.

\textbf{DFM의 KOIPALL.G 성능 문제:} DFM은 KOIPALL.G에 대해서 극단적으로 높은 오차(sMAE=14.97, sMSE=225.30)를 보임. 이는 KOIPALL.G가 월별 시계열인데 dfm-python 라이브러리의 기본 설정이 분기별 집계를 가정한 "tent kernel" 구조(ppC=5)를 사용하여 상태 차원이 과도하게 증가하고, EM 알고리즘이 수렴하지 않거나 폭발적인 예측을 생성하기 때문임. 반면 DDFM은 비선형 인코더를 통해 이러한 문제를 효과적으로 해결하여 KOIPALL.G에서 우수한 성능을 보임.

\textbf{DDFM의 성능 특성:} DDFM은 KOIPALL.G와 KOWRCCNSE에서 우수한 성능을 보이며, 특히 KOIPALL.G에서 DFM 대비 약 21.8배 낮은 오차를 보임(sMAE: DDFM=0.6865 vs DFM=14.9689, 개선율 95.4\%). KOWRCCNSE에서도 DDFM이 DFM 대비 약 5.6배 낮은 오차를 보임(sMAE: DDFM=0.4961 vs DFM=2.7848, 개선율 82.2\%). 

KOEQUIPTE에서는 DFM과 동일한 성능을 보이는데(sMAE: DFM=1.1439, DDFM=1.1441, 평균 차이 0.000187, 21개 시점; sMSE: 2.12), 이는 두 모형이 유사한 요인 구조를 학습했을 가능성을 시사함. 구체적으로, KOEQUIPTE에서 DFM과 DDFM은 21개 시점 모두에서 거의 동일한 오차를 보이며, 정량적 분석 결과:
\begin{itemize}
    \item 최대 sMAE 차이: 0.00212 (horizon 2: DFM=1.45051, DDFM=1.44847)
    \item 최소 sMAE 차이: 0.00001 (horizon 15: DFM=0.08423, DDFM=0.08548)
    \item 평균 sMAE 차이: 0.00085 (21개 시점 전체)
    \item 상대 차이: 모든 시점에서 < 0.15\% (|DDFM - DFM| / DFM < 0.0015)
    \item sMSE와 sRMSE에서도 유사한 패턴 관찰 (평균 차이 < 0.001)
\end{itemize}
이는 DDFM의 비선형 인코더가 KOEQUIPTE에 대해 추가적인 이점을 제공하지 못하며, 인코더가 선형 PCA와 유사한 요인 구조를 학습하고 있음을 강하게 시사함. 

DDFM의 비선형 인코더는 변동성이 큰 시계열(KOIPALL.G, KOWRCCNSE)에서 선형 DFM보다 더 강건한 성능을 보임. KOEQUIPTE에서의 성능 개선을 위해 다음과 같은 개선 사항을 구현하였으나, 효과를 검증하기 위해서는 모델 훈련 후 추가 실험 재실행이 필요함:
\begin{itemize}
    \item 더 깊은 인코더 구조([64, 32, 16]) - 기본 [16, 4] 대비 용량 증가
    \item tanh 활성화 함수 - 음의 상관관계 포착을 위해 (기본 ReLU 대신)
    \item 가중치 감쇠(L2 정규화, weight\_decay=1e-4) - 선형 붕괴 방지
    \item 그래디언트 클리핑 - 훈련 안정성 향상
    \item Huber 손실 함수 지원 - 이상치에 대한 강건성 향상
    \item 향상된 가중치 초기화 - Xavier/Kaiming 초기화
    \item 요인 차수 설정 - VAR(2) 지원 (기본 VAR(1) 대신)
    \item 증가된 사전 훈련 (mult\_epoch\_pretrain=2) - 인코더가 MCMC 전에 비선형 특징 학습 시간 확보
    \item 배치 크기 최적화 (batch\_size=64) - 더 다양한 그래디언트로 선형 해 탈출 지원
\end{itemize}

\textbf{시점별 성능 패턴의 정량적 분석:} 시점별 성능을 분석하면 모형의 예측 안정성을 평가할 수 있음. KOIPALL.G에서 DDFM은 단기(1-6개월)에서 매우 우수한 성능을 보이며, horizon 1에서 sMAE=0.12, horizon 6에서 sMAE=0.15로 매우 낮은 오차를 보임. 중기(7-12개월)에서는 sMAE가 0.39-0.95 범위로 증가하지만 여전히 양호한 수준이며, 장기(13-21개월)에서는 sMAE가 0.54-1.33 범위로 일부 증가하나 전반적으로 안정적임. 반면 DFM은 모든 시점에서 극단적으로 높은 오차를 보이며, 최소값이 horizon 3에서 sMAE=12.47, 최대값이 horizon 18에서 sMAE=16.78임. KOWRCCNSE에서 VAR은 단기(1-3개월)에서 우수한 성능을 보이지만(sMAE: 0.24-0.38), horizon 2에서 sMAE=0.98로 급증한 후 다시 감소하는 패턴을 보임. 중기(4-12개월)에서는 대부분 sMAE < 0.22를 보이지만, horizon 14(sMAE=0.59), horizon 19(sMAE=0.90), horizon 22(sMAE=1.14)에서 오차가 급증함. DDFM은 대부분의 시점에서 안정적이며, horizon 1에서 sMAE=0.09, horizon 4-8에서 sMAE < 0.14를 보임. KOEQUIPTE에서 DFM과 DDFM은 모든 시점에서 거의 동일한 성능을 보이며, 단기(1-3개월)에서 sMAE 1.03-1.07, 중기(4-12개월)에서 sMAE 0.21-0.76, 일부 시점(7-8, 13-14개월)에서 sMAE 1.64-3.28로 증가하는 패턴을 공유함.

이러한 결과는 각 모형의 구조적 특성을 반영함: VAR은 선형 다변량 모형으로 일부 대상 변수에서 우수한 성능을 보이며, DFM은 전통적인 요인 모형으로 변동성이 큰 시계열에서는 수치적 불안정성을 보일 수 있음. DDFM은 비선형 인코더를 통해 이러한 한계를 극복하여 변동성이 큰 시계열에서 우수한 성능을 보임. 

\textbf{DDFM 성능 평가 메트릭:} DDFM의 성능을 더 정확히 평가하기 위해 다양한 향상된 메트릭이 구현되어 있음. 이러한 메트릭들은 결과 집계 시 자동으로 계산되며, DDFM의 선형 붕괴(linear collapse) 문제를 조기에 감지하고 개선 방향을 제시하는 데 도움을 줌. 

시점 가중 메트릭은 실용적 예측 관점에서 단기 예측(1-6개월, 가중치 2.0)에 더 높은 가중치를 부여하여 모델 성능을 평가함. 훈련 정렬 메트릭은 모델이 훈련 중 최적화한 손실 함수(MSE 또는 Huber)와 일치하는 평가 메트릭을 계산하여, 모델이 실제로 최적화한 목표에 대한 성능을 정확히 측정함. 상대 오차 안정성 메트릭은 DDFM과 DFM 간의 상대적 성능이 시점에 따라 일관적인지 평가하며, 개선 지속성 메트릭은 DDFM의 개선이 체계적인지 일시적인지 구분함. 

강건 통계 기반 메트릭은 중앙값과 IQR을 사용하여 이상치에 강건한 성능 평가를 제공함. 특히 KOEQUIPTE와 같이 일부 시점(horizon 7-8, 13-14)에서 극단적 오차가 발생하는 경우, 평균 기반 메트릭이 왜곡될 수 있으므로 중앙값 기반 메트릭이 더 신뢰할 수 있는 성능 평가를 제공함. 부트스트랩 신뢰구간은 메트릭의 불확실성을 정량화하여 통계적 신뢰성을 향상시킴. 기본적으로 1000회 재표본 추출을 수행하여 95\% 신뢰구간을 제공하며, DDFM과 DFM 간의 성능 차이를 통계적으로 검증하는 데 도움을 줌. 

요인 동역학 안정성 추론 메트릭은 VAR 요인 동역학의 안정성을 예측 패턴으로부터 간접적으로 평가함. 이 메트릭은 진동, 지수적 성장/감쇠, 예측 평활도, 발산/수렴 패턴을 감지하여 요인 동역학의 수치적 불안정성을 조기에 발견하는 데 도움을 줌. 

예측 기술 점수(forecast skill score) 메트릭은 DDFM의 성능을 단순 기준선(무작위 보행 또는 평균 예측)과 비교하여 정량화함. 기술 점수는 -inf에서 1.0 범위의 값을 가지며, 1.0은 완벽한 예측, 0.0은 기준선과 동일, 음수는 기준선보다 나쁨을 의미함. MSE, MAE, RMSE에 대해 각각 기술 점수를 계산하여 DDFM 성능을 더 해석 가능한 방식으로 평가함. 

정보 획득(information gain) 메트릭은 DDFM이 DFM 대비 제공하는 추가 정보의 양을 측정함. KL 발산 방법과 상호 정보량 방법을 사용하여 DDFM 인코더가 학습한 비선형 특징의 가치를 정량화하며, DDFM이 DFM과 다른 패턴을 학습하고 있는지 식별하는 데 도움을 줌. 

상대적 기술 평가(relative skill assessment) 메트릭은 실제 예측값이 없는 경우에도 오차 메트릭을 사용하여 기술 점수와 유사한 평가를 제공함. 이 메트릭은 DDFM의 성능을 DFM 및 기준 모형(VAR)과 비교하여 기술 수준을 HIGH(>10\% 개선), MODERATE(5-10\% 개선), LOW(유사), NEGATIVE(저하)로 분류하며, 시점별 기술 평가와 기술 일관성을 제공함. 이를 통해 DDFM의 상대적 성능을 더 해석하기 쉽게 평가할 수 있음.

근선형 붕괴 감지(near-linear collapse detection) 메트릭은 DDFM과 DFM의 오차가 수치적 정밀도 범위 내(< 0.01 절대 차이, < 0.1\% 상대 차이)에 있는 경우를 특별히 감지함. 이 메트릭은 선형성 감지보다 더 강한 신호를 제공하며, KOEQUIPTE와 같이 모든 시점에서 DDFM과 DFM의 오차가 거의 동일한 경우를 조기에 감지함. 근붕괴 점수(0-1, 높을수록 근붕괴 가능성)와 근붕괴 비율을 계산하여 수치적 정밀도 수준의 선형 붕괴를 조기에 발견하는 데 도움을 줌.

분위수 기반 오차 메트릭(quantile-based error metrics)은 평균 기반 메트릭이 이상치에 민감한 문제를 해결하기 위해 여러 분위수(0.1, 0.25, 0.5, 0.75, 0.9)에서 sMAE와 sMSE를 계산함. 중앙값(0.5 분위수)은 평균보다 이상치에 강건한 성능 지표를 제공하며, IQR sMAE는 오차 분포의 퍼짐 정도를 측정함. 꼬리 비율(90번째/10번째 분위수)은 오차 분포의 꼬리 두께를 측정하여 가끔 극단적인 예측 오차가 발생하는지 식별함. 이 메트릭은 변동성이 큰 시점이나 왜도가 있는 오차 분포에서 더 신뢰할 수 있는 성능 평가를 제공함.

향상된 시점별 개선 추적 기능은 각 시점을 개선 수준에 따라 분류함(유의미한 개선 >10\%, 중간 개선 5-10\%, 경미한 개선 0-5\%, 개선 없음, 성능 저하). 이를 통해 DDFM이 어떤 시점에서 가장 큰 이점을 제공하는지 파악할 수 있으며, 시점별 개선 전략을 최적화할 수 있음.

오차 패턴 평활도(error pattern smoothness) 메트릭은 DDFM의 오차 패턴이 시점 간에 얼마나 일관적이고 평활한지를 측정함. 변동 계수(CV), 1차 차분, 2차 차분, 자기상관을 사용하여 평활도 점수(0-1, 높을수록 평활)를 계산하며, 인코더가 잘 학습된 경우 비선형 특징이 시점 간 일관된 성능을 제공하므로 더 평활한 오차 패턴을 보일 것으로 기대됨. KOEQUIPTE의 경우 낮은 평활도 점수가 예상되며, 이는 시점 간 오차 변동성이 크고 일관성이 낮음을 시사함.

개선 통계적 유의성 검정(improvement significance testing) 메트릭은 부트스트랩 재표본 추출을 통해 DDFM의 개선이 통계적으로 유의한지를 검정함. 기본적으로 1000회 부트스트랩 재표본 추출을 수행하여 개선 비율의 신뢰구간을 계산하고, 개선이 통계적으로 유의한지(신뢰구간이 0을 포함하지 않음)를 판단함. p-value, 유의한 시점 목록, 시점별 유의성 분석을 제공하여 DDFM 개선이 실제 개선인지 랜덤 변동인지 구분함. KOEQUIPTE의 경우 개선 비율이 거의 0\%이므로 통계적으로 유의하지 않을 것으로 예상됨.

체계적 편향 감지(systematic bias detection) 메트릭은 DDFM이 DFM보다 일관되게 나쁜 성능을 보이는 경우를 감지함. 체계적 편향 점수(0-1, 높을수록 DDFM이 DFM보다 일관되게 나쁨), 근선형 붕괴 비율(근선형 붕괴를 보이는 시점의 비율), DDFM 저하 비율(DDFM이 DFM보다 나쁜 시점의 비율)을 계산하여 KOEQUIPTE와 같이 DDFM이 DFM과 거의 동일한 성능을 보이는 경우를 정량적으로 진단함. KOEQUIPTE의 경우 근선형 붕괴 비율이 1.0(모든 시점에서 근선형 붕괴)이고, 체계적 편향 점수가 높을 것으로 예상됨.

이러한 메트릭들은 \texttt{analyze\_ddfm\_prediction\_quality()} 함수에 통합되어 결과 집계 시 자동으로 계산되며, 결과는 \texttt{outputs/experiments/ddfm\_linearity\_analysis.json}에 저장됨. 특히 KOEQUIPTE의 경우, 현재 실험 결과에서 선형성 점수가 0.99 이상으로 관찰되어 인코더가 선형 PCA와 유사한 해에 수렴했음을 강하게 시사하며, 이러한 메트릭들을 통해 선형 붕괴 문제를 정량적으로 진단할 수 있음. 비선형성 점수는 DDFM 예측이 얼마나 비선형적인지를 정량화하는 보완적 메트릭으로, 패턴 발산도, 오차 비선형성, 시점 상호작용 효과를 종합하여 계산됨. 점수 < 0.2는 선형 붕괴 가능성을, 점수 > 0.7은 높은 비선형성을 의미하며, KOEQUIPTE의 경우 낮은 비선형성 점수가 예상됨.

\textbf{향상된 오차 분포 분석:} DDFM의 예측 오차를 더 자세히 분석하기 위해 각 시점별로 오차 분포 메트릭을 계산함. 이러한 메트릭들은 \texttt{calculate\_standardized\_metrics()} 함수에서 계산되며, \texttt{aggregate\_overall\_performance()} 함수를 통해 집계 결과에 저장됨. 

주요 오차 분포 메트릭은 다음과 같음:
\begin{itemize}
    \item \textbf{오차 왜도 (error\_skewness):} 오차 분포의 비대칭성을 측정하여 체계적인 과대/과소 예측 패턴을 식별함. 양수는 오른쪽 꼬리가 긴 분포(가끔 큰 과대 예측)를 의미하고, 음수는 왼쪽 꼬리가 긴 분포(가끔 큰 과소 예측)를 의미함.
    \item \textbf{오차 첨도 (error\_kurtosis):} 오차 분포의 꼬리 두께를 측정하여 이상치에 취약한 예측을 식별함. 양수는 무거운 꼬리(가끔 극단적인 예측 오차)를 의미하고, 음수는 가벼운 꼬리(안정적인 예측)를 의미함.
    \item \textbf{오차 편향 제곱 (error\_bias\_squared):} 편향-분산 분해에서 체계적 편향 성분을 측정하여 모델의 구조적 한계를 파악함. 높은 값은 체계적인 과대/과소 예측을 의미하며, 이는 모델 구조 개선이 필요함을 시사함.
    \item \textbf{오차 분산 (error\_variance):} 편향-분산 분해에서 분산 성분을 측정하여 예측 불안정성을 평가함. 높은 값은 예측이 불안정함을 의미하며, 이는 정규화나 앙상블 방법으로 개선할 수 있음.
    \item \textbf{오차 집중도 (error\_concentration):} 오차가 균등하게 분포되어 있는지(0에 가까움) 아니면 특정 시점에 집중되어 있는지(1에 가까움)를 측정하여 체계적 문제를 식별함. 높은 집중도는 특정 시점에서 체계적인 문제가 있음을 시사함.
\end{itemize}

KOEQUIPTE의 경우, DDFM과 DFM의 오차 분포 메트릭이 거의 동일하게 관찰되며, 이는 두 모형이 유사한 오차 패턴을 보인다는 것을 의미함. 구체적으로, 오차 왜도와 첨도가 유사하면 두 모형의 오차 분포가 거의 동일하며, 이는 DDFM 인코더가 선형 특징만 학습하고 있음을 시사함. 이러한 진단 메트릭들을 통해 예측 오차의 원인을 더 정확히 파악하고, 편향과 분산 중 어느 쪽을 개선해야 하는지 결정할 수 있음. 예를 들어, 높은 오차 편향 제곱과 낮은 오차 분산은 모델 구조 개선(인코더 아키텍처, 활성화 함수)이 필요함을 시사하고, 낮은 오차 편향 제곱과 높은 오차 분산은 정규화나 앙상블 방법이 도움이 될 수 있음을 시사함. 이러한 진단 메트릭들은 DDFM의 선형 붕괴 위험 평가에 활용되며, \texttt{analyze\_ddfm\_prediction\_quality()} 함수에서 자동으로 분석됨.

