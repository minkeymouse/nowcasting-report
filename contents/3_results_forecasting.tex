\subsubsection{Forecasting}

본 절에서는 세 가지 대상 변수(생산: KOIPALL.G, 투자: KOEQUIPTE, 소비: KOWRCCNSE)에 대한 네 가지 예측 모형(ARIMA, VAR, DFM, DDFM)의 예측 성능을 비교함. 실험은 1개월부터 22개월까지의 시점에 대해 수행되었으며, 표~\ref{tab:forecasting_results}에는 모든 시점(1-22개월)에 대한 평균값을 제시함. 

\textbf{실험 완료 상태:} 
\begin{itemize}
    \item \textbf{VAR:} 세 대상 변수 모두에서 22개 시점(1-22개월)에 대해 성공적으로 평가되었으며, 총 66개 결과 포인트(3개 대상 변수 × 22개 시점)를 생성함.
    \item \textbf{DFM:} 세 대상 변수 모두에서 평가되었으나, KOIPALL.G와 KOEQUIPTE에서는 22개월 시점의 결과가 누락되어(n\_valid=0) 21개 시점에 대한 결과만 사용 가능함. KOWRCCNSE에 대해서는 22개 시점에 대한 결과가 있음. 전체적으로 DFM은 64개 결과 포인트(21+21+22)를 생성함.
    \item \textbf{DDFM:} 세 대상 변수 모두에서 평가되었으나, KOIPALL.G와 KOEQUIPTE에서는 22개월 시점의 결과가 누락되어(n\_valid=0) 21개 시점에 대한 결과만 사용 가능함. KOWRCCNSE에 대해서는 22개 시점에 대한 결과가 있음. 전체적으로 DDFM은 64개 결과 포인트(21+21+22)를 생성함.
    \item \textbf{ARIMA:} 세 대상 변수 모두에서 평가되었으나, KOIPALL.G와 KOEQUIPTE에서는 22개월 시점의 결과가 누락되어(n\_valid=0) 21개 시점에 대한 결과만 사용 가능함. KOWRCCNSE에 대해서는 22개 시점에 대한 결과가 있음. 전체적으로 ARIMA는 64개 결과 포인트(21+21+22)를 생성함.
\end{itemize}
전체 실험 결과 완전도는 약 98\% (258개 유효 결과 / 264개 전체 결과 포인트)임. 누락된 결과는 ARIMA의 horizon 22 누락(2개 포인트)과 DFM/DDFM의 horizon 22 누락(4개 포인트)에 기인함.

표~\ref{tab:forecasting_results}는 모형별 타겟별로 모든 시점(1-22개월)에 대한 평균 표준화된 MAE와 MSE를 제시함. 각 셀은 해당 모형-타겟 조합의 평균 지표값을 나타내며, 각 지표에서 최소값(최고 성능)은 굵은 글씨로 표시됨. 상세한 시점별 결과는 부록에 제시됨.

\input{tables/tab_forecasting_results}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\textwidth]{images/forecast_vs_actual_koipall_g.png}
\caption{예측 대 실제: 전산업생산지수 (KOIPALL.G). 히스토리 기간(2023-01 to 2023-12)에는 실제값만 표시되며, 예측 기간(2024-01 to 2025-10)에는 실제값과 모형 예측값(ARIMA, VAR, DFM, DDFM)이 함께 표시됨. 모든 값은 원본 데이터 스케일로 표시됨.}
\label{fig:forecast_vs_actual_koipallg}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\textwidth]{images/forecast_vs_actual_koequipte.png}
\caption{예측 대 실제: 설비투자지수 (KOEQUIPTE). 히스토리 기간(2023-01 to 2023-12)에는 실제값만 표시되며, 예측 기간(2024-01 to 2025-10)에는 실제값과 모형 예측값(ARIMA, VAR, DFM, DDFM)이 함께 표시됨. 모든 값은 원본 데이터 스케일로 표시됨.}
\label{fig:forecast_vs_actual_koequipte}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\textwidth]{images/forecast_vs_actual_kowrccnse.png}
\caption{예측 대 실제: 도소매판매액 (KOWRCCNSE). 히스토리 기간(2023-01 to 2023-12)에는 실제값만 표시되며, 예측 기간(2024-01 to 2025-10)에는 실제값과 모형 예측값(ARIMA, VAR, DFM, DDFM)이 함께 표시됨. 모든 값은 원본 데이터 스케일로 표시됨.}
\label{fig:forecast_vs_actual_kowrccnse}
\end{figure}

그림~\ref{fig:forecast_vs_actual_koipallg}, 그림~\ref{fig:forecast_vs_actual_koequipte}, 그림~\ref{fig:forecast_vs_actual_kowrccnse}는 각 대상 변수별로 히스토리 기간(2023-01 to 2023-12)과 예측 기간(2024-01 to 2025-10)의 실제 값 및 예측 값을 비교한 플롯임. 히스토리 기간에는 실제 값만 표시되며, 예측 기간에는 실제 값과 모형 예측값(ARIMA, VAR, DFM, DDFM)이 함께 표시됨. 모든 값은 원본 데이터 스케일로 표시되며, X축은 월별 타임스탬프, Y축은 대상 변수 값임.

표~\ref{tab:forecasting_results}의 결과를 보면, ARIMA, VAR, DFM, DDFM 모두 세 대상 변수에서 평가되었음. 각 모형은 대상 변수에 따라 매우 다른 성능 특성을 보임. 

\textbf{전체 시점 평균 성능 (표~\ref{tab:forecasting_results}):} KOIPALL.G에서는 DDFM이 가장 낮은 sMAE(0.6865, 21개 시점 평균)와 sMSE(0.61)를 보여 우수한 성능을 보임. VAR(sMAE=0.94, sMSE=1.11)도 양호한 성능을 보이며, DFM(sMAE=14.9689, sMSE=225.30)은 매우 높은 오차를 보여 KOIPALL.G에 대해서는 부적합함. KOEQUIPTE에서는 DFM과 DDFM이 거의 동일한 성능을 보이며(sMAE: DFM=1.1439, DDFM=1.1441, 평균 차이 0.000187, 21개 시점; sMSE: DFM=2.115, DDFM=2.115, 차이 0.0003), VAR(sMAE=1.37, sMSE=2.97)이 상대적으로 높은 오차를 보임. KOWRCCNSE에서는 VAR이 가장 낮은 sMAE(0.32)와 sMSE(0.20)를 보여 우수한 성능을 보이며, DDFM(sMAE=0.4961, sMSE=0.49)도 양호한 성능을 보임. DFM(sMAE=2.7848, sMSE=8.21)은 상대적으로 높은 오차를 보임.

\textbf{DFM의 KOIPALL.G 성능 문제:} DFM은 KOIPALL.G에 대해서 극단적으로 높은 오차(sMAE=14.97, sMSE=225.30)를 보임. 이는 KOIPALL.G가 월별 시계열인데 dfm-python 라이브러리의 기본 설정이 분기별 집계를 가정한 "tent kernel" 구조(ppC=5)를 사용하여 상태 차원이 과도하게 증가하고, EM 알고리즘이 수렴하지 않거나 폭발적인 예측을 생성하기 때문임. 반면 DDFM은 비선형 인코더를 통해 이러한 문제를 효과적으로 해결하여 KOIPALL.G에서 우수한 성능을 보임.

\textbf{DDFM의 성능 특성:} DDFM은 KOIPALL.G와 KOWRCCNSE에서 우수한 성능을 보이며, 특히 KOIPALL.G에서 DFM 대비 약 21.8배 낮은 오차를 보임(sMAE: DDFM=0.6865 vs DFM=14.9689, 개선율 95.4\%). KOWRCCNSE에서도 DDFM이 DFM 대비 약 5.6배 낮은 오차를 보임(sMAE: DDFM=0.4961 vs DFM=2.7848, 개선율 82.2\%). 

KOEQUIPTE에서는 DFM과 동일한 성능을 보이는데(sMAE: DFM=1.1439, DDFM=1.1441, 평균 차이 0.000187, 21개 시점), 이는 두 모형이 유사한 요인 구조를 학습했을 가능성을 시사함. 21개 시점 모두에서 거의 동일한 오차를 보이며(평균 차이 < 0.001, 상대 차이 < 0.15\%), DDFM의 비선형 인코더가 KOEQUIPTE에 대해 추가적인 이점을 제공하지 못함을 시사함. 

DDFM의 비선형 인코더는 변동성이 큰 시계열(KOIPALL.G, KOWRCCNSE)에서 선형 DFM보다 더 강건한 성능을 보임. KOEQUIPTE에서의 성능 개선을 위해 다음과 같은 개선 사항을 구현하였으나, 효과를 검증하기 위해서는 모델 훈련 후 추가 실험 재실행이 필요함:
\begin{itemize}
    \item 더 깊은 인코더 구조([64, 32, 16]) - 기본 [16, 4] 대비 용량 증가
    \item tanh 활성화 함수 - 음의 상관관계 포착을 위해 (기본 ReLU 대신)
    \item 가중치 감쇠(L2 정규화, weight\_decay=1e-4) - 선형 붕괴 방지
    \item 그래디언트 클리핑 - 훈련 안정성 향상
    \item Huber 손실 함수 지원 - 이상치에 대한 강건성 향상
    \item 향상된 가중치 초기화 - Xavier/Kaiming 초기화
    \item 요인 차수 설정 - VAR(2) 지원 (기본 VAR(1) 대신)
    \item 증가된 사전 훈련 (mult\_epoch\_pretrain=2) - 인코더가 MCMC 전에 비선형 특징 학습 시간 확보
    \item 배치 크기 최적화 (batch\_size=64) - 더 다양한 그래디언트로 선형 해 탈출 지원
\end{itemize}

\textbf{시점별 성능 패턴:} KOIPALL.G에서 DDFM은 단기(1-6개월)에서 매우 우수한 성능을 보이며, 장기(13-21개월)에서도 안정적임. 반면 DFM은 모든 시점에서 극단적으로 높은 오차를 보임. KOWRCCNSE에서 VAR은 단기에서 우수하나 일부 시점에서 오차가 급증하며, DDFM은 대부분의 시점에서 안정적임. KOEQUIPTE에서 DFM과 DDFM은 모든 시점에서 거의 동일한 성능을 보임.

이러한 결과는 각 모형의 구조적 특성을 반영함: VAR은 선형 다변량 모형으로 일부 대상 변수에서 우수한 성능을 보이며, DFM은 전통적인 요인 모형으로 변동성이 큰 시계열에서는 수치적 불안정성을 보일 수 있음. DDFM은 비선형 인코더를 통해 이러한 한계를 극복하여 변동성이 큰 시계열에서 우수한 성능을 보임. 

\textbf{DDFM 성능 평가 메트릭:} DDFM의 성능을 더 정확히 평가하기 위해 다양한 향상된 메트릭이 구현되어 있음. 시점 가중 메트릭, 강건 통계 기반 메트릭, 부트스트랩 신뢰구간, 오차 분포 분석(왜도, 첨도, 편향 제곱, 분산, 집중도) 등을 통해 선형 붕괴 문제를 조기에 감지하고 개선 방향을 제시함. 특히 KOEQUIPTE의 경우 선형성 점수가 0.99 이상으로 관찰되어 인코더가 선형 PCA와 유사한 해에 수렴했음을 시사함.

