□ DFM(Dynamic Factor Model)
◦ 공통 요인 개수는 7개, 요인 시차는 4로 설정하여 기존 실시간 경기 진단 모형과 동일한 설정을 유지
◦ FRBNY Staff Nowcast 계열의 블록 구조를 참고하였고, 주간→월간 혼합주기 처리는 tent kernel 집계(Mariano and Murasawa, 2003) 아이디어를 차용
◦ 현 구현에서는 생산/투자 지표 각각 학습에 약 6시간이 소요되어 반복 실험 비용이 큼(구현 특성상 GPU 병렬화 이점이 제한적)
◦ 학습 과정에서 수렴이 불안정하게 나타나는 경우가 있었으며, 특히 생산 지표는 변수 간 높은 상관관계 및 정보량(유효 신호) 측면에서 학습 난이도가 높게 관측됨
◦ 추정 과정(초기값 설정 포함)에 따라 수렴/안정성이 민감하게 달라지는 것을 확인
◦ 동학 모델링:
f _{t} =A _{f} f _{t-1} +v _{t}
epsilon  _{t} =A _{epsilon } epsilon  _{t-1} +u _{t}
y _{t} =C[f _{t} ; epsilon  _{t} ]+e _{t}

□ DDFM(Deep Dynamic Factor Model)
◦ DFM의 "상태공간" 구조를 유지하되,  관측치와 요인의 관계를 비선형 신경망으로 확장하여 좀더 유연하게 포착하는 접근
◦ Autoencoder 구조를 활용하여 대규모 시계열에서의 공통요인을 학습을 가능하도록 함과 동시에 딥러닝을 통해 요인의 표현력(expressiveness)를 늘려 예측력을 개선하는 것을 목표로 함
◦ 변환 관점에서 \(X\)를 저차원의 잠재요인으로 압축한 뒤(encoder) 이를 기반으로 예측치를 산출(decoder): \(X \rightarrow f \rightarrow \hat{Y}\)
◦ 결측치가 있는 변수/시점은 요인 추출(인코더) 과정에서 제외하여, 관측된 데이터만으로 공통요인을 추출
◦ 혼합주기 데이터(주간–월간)의 경우, 월간 시계열은 변환(차분 등)을 위해 먼저 월간으로 집계한 뒤 변환을 적용하고, 다시 주간 형식으로 확장하여 인코더에 입력(월말 주에만 값이 있고 나머지는 NaN). 인코더는 이 주간 형식의 혼합주기 데이터를 직접 처리하며, 집계는 예측 단계에서 평가를 위해만 수행됨
◦ 동학 모델링(Psi, Phi는 인코더 함수):
f_{t} = Phi(y_{t}) #
f _{t} =Af _{t-1} +u _{t}#
y _{t} = Psi( f _{t} )


□ MAMBA
◦ 기존 상태공간 모형이 입력 변환, 상태 전이, 그리고 출력 변환을 시간 불변으로 두고 모델링 한 것을 시간에 따라 변하도록 모델링함
◦ 필요한 정보를 거르는 gate MLP블록과 시간 가변 상태 공간 모델링을 하는 selective SSM 블록을 scan 기반 연산으로 GPU를 통해 병렬 처리함
◦ DFM, DDFM과는 달리 요인이 결정(deterministic)적이기 때문에 동학의 확률성(stochasticity)을 가정하지 않음
◦ 동학 모델링:
f _{t} ={bar A_t}(x_{t}) f _{t-1} + {bar B_t}(x_{t}) x _{t}#
y _{t} = C_{t}(x_{t}) f_{t} 
◦ bar A, bar B, C 모두 입력에 의해 의존적으로 변하는 동적인 행렬
◦ 다변량 예측보다 단변량 예측의 지표가 좋게 나와 단순 Mamba 블록을 활용한 예측에서는 공변량이 도움이 되지 않음을 확인


□ 단기 예측 실험 구성
◦ 앞 실험과 동일한 기간, 동일한 평가지표 및 업데이트 방식 사용
◦ 상태공간 계열 모델의 경우 (로그)차분, 표준화 등 데이터 전처리를 거친 후 모델이 학습, 예측 시 역변환한 값을 기준으로 평가 지표 계산
◦ 최신 데이터를 활용하여 재귀적 예측 시 상태 업데이트: 앞선 실험과 마찬가지로 전체 재학습은 시행하지 않음

□ 단기예측 실험 결과

| 모델명 | 생산 지표 단기 예측 | | 투자 지표 단기 예측 | |
|--------|-------------------|--|-------------------|--|
| | sMSE | sMAE | sMSE | sMAE |
| DFM | 1.955 | 1.165 | 1.657 | 1.006 |
| DDFM | 1.944 | 1.146 | 1.639 | 0.987 |
| MAMBA | 4.302 | 1.704 | 1.410 | 0.872 |

□ 단기 예측 결과 해석
◦ DDFM은 DFM과 유사하면서도 개선된 결과를 보임: DDFM의 디코더를 DFM과 동일하게 선형으로 지정하였기 때문으로 여겨짐
◦ 생산 지표에서 상태공간 모델의 일반화된 구조적 동학 표현이 정보 부족 이슈에 상대적으로 적합했음이 나타남
◦ 투자 지표에서는 MAMBA의 시간 가변 선택적 상태공간 구조가 다양한 변수간 관계를 포착하는 데 일부 효과적이었음을 확인하였고, 정보가 많은 경우 MAMBA가 강점을 가질 수 있음
◦ MAMBA의 생산 지표 예측시 낮은 성능은 선택적 정보 필터링이 오히려 유효 신호 손실로 이어졌을 가능성을 시사
◦ 상태공간 모델들은 어텐션 계열 모델과 달리 결측치를 구조적으로 처리할 수 있어 보간 의존도가 낮고, 상태 업데이트를 통해 재귀적 예측 시 동학을 일관되게 유지할 수 있는 장점이 있음

□ 장기 예측 결과 해석
◦ 앞 실험과 동일한 기간, 동일한 평가지표 및 업데이트 방식 사용
◦ 상태공간 기반 모형의 경우 전반적으로 어텐션 계열 모델과 비교하여 특정 horizon에서 경쟁력 있는 성능을 보임.
◦ 상태공간 구조가 장기 동학을 구조적으로 포착하는 데 일부 효과적이었음을 시사
◦ 투자 지표에서 나타난 3~4개월 horizon에서 극심한 성능 저하의 경우 재귀적 상태 업데이트 없이 한번에 긴 기간을 예측하는 방식이 특정 시점에서 상태 전이의 불안정성으로 이어졌을 가능성이 고려됨
◦ 상태공간 모델의 장점인 horizon-agnostic 특성(예측기간을 지정할 필요 없이 동일 모델 사용)에도 불구하고, 재귀적 업데이트 없이 한번에 장기 예측을 수행할 때는 전이의 누적 오차나 특정 시점에서의 불안정성이 성능에 큰 영향을 미칠 수 있음을 발견.
◦ 투자 지표의 경우 변수 간 관계가 복잡하고 정보가 다양하여 이러한 문제가 더 두드러지게 나타남



