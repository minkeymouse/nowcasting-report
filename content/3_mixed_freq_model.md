3. 혼합 주기 모형

다중 스케일 혼합(Multiscale Mixing) : 시계열 데이터가 서로 다른 샘플링 스케일에서 다른 패턴을 보인다는 관찰에 기반하여, 미시적 정보는 세밀한 스케일에서, 거시적 정보는 거친 스케일에서 반영된다는 점을 활용. 이를 통해 복잡한 시계열 변동을 본질적으로 분리(disentangle)하여 모델링할 수 있음.
◦ 다양한 스케일에서 분리된 계절성(seasonality)과 추세(trend) 성분을 각각 다른 방향으로 혼합하여 과거 정보를 추출하고, 미래 예측을 위해 여러 스케일의 예측기를 앙상블하는 방식으로 작동.
◦ 완전히 MLP 기반 구조로 구현되어 계산 효율성이 높고, 장기 및 단기 예측 모두에서 일관된 성능을 보임.

□ TimeMixer
◦ 입력 시계열을 다중 스케일로 다운샘플링하여 여러 해상도에서 표현: X IN  R ^{B TIMES  T TIMES  N} rarrow  [X_{0}, X_{1}, ..., X_{M}]  여기서  X_{m} IN  R ^{B TIMES  [T/w^{m}] TIMES  N}
◦ Past-Decomposable-Mixing (PDM) 블록을 통해 각 스케일에서 계절성과 추세를 분해한 후, 계절성은 미세→거친(bottom-up) 방향으로, 추세는 거친→미세(top-down) 방향으로 혼합
◦ Future-Multipredictor-Mixing (FMM) 블록에서 각 스케일별 예측기를 앙상블하여 최종 예측 생성:  hat{X} = SUM _{m=0}^{M} Predictor_{m}(X_{m}^{L}) 
◦ B는 배치 크기, T는 시점 수, N은 변수 개수, M은 스케일 개수, w는 다운샘플링 윈도우 크기, L은 PDM 레이어 수를 의미
◦ 주간 클럭 주파수와 월간 시계열이 혼합된 데이터의 경우, 다운샘플링 윈도우를 4로 설정하여 첫 번째 스케일을 월간 주파수(~4주)에 맞추도록 구성 가능

□ 다중 스케일 구조
◦ 다운샘플링을 통해 원본 시계열에서 여러 스케일의 표현을 생성: 평균 풀링(avg), 최대 풀링(max), 또는 컨볼루션(conv) 방법 사용
◦ 각 스케일에서 moving average 또는 DFT(Discrete Fourier Transform) 기반 분해를 통해 계절성과 추세 성분 분리
◦ 계절성 혼합(MultiScaleSeasonMixing): 세밀한 스케일의 계절성 패턴을 거친 스케일로 집약(bottom-up aggregation)
◦ 추세 혼합(MultiScaleTrendMixing): 거친 스케일의 추세 정보를 세밀한 스케일로 분산(top-down distribution)
◦ 스케일 간 혼합을 통해 미시적 계절성 정보와 거시적 추세 정보를 동시에 활용

□ 혼합 주기 데이터 활용
◦ 주간 클럭 주파수 데이터에서 월간 시계열은 자연스럽게 스파스한 특성을 가지므로, 다운샘플링 윈도우를 4로 설정하면 첫 번째 스케일(96주 → 24개월)이 월간 시계열의 자연 주파수와 유사한 구조를 갖게 됨
◦ 주간 시계열은 세밀한 스케일에서 다중 스케일 다운샘플링의 이점을 받으며, 월간 시계열은 첫 번째 스케일에서 대략적으로 자연 주파수에 정렬됨
◦ 모든 시계열에 동일한 다운샘플링이 적용되지만, 스케일 구조가 혼합 주파수 데이터의 특성을 부분적으로 반영

□ 단기예측 실험 구성
◦ 2024년 1월 1주 ~ 2025년 9월 4주를 한 주 단위로 재귀적으로 예측한 후 비교
◦ TimeMixer의 경우 결측치가 있으면 학습이 불가능하기 때문에, 보간을 적용
◦ 학습은 '주간' 데이터를 기준으로 이루어진 반면 예측은 '월간' 데이터이므로 주간 예측을 실시하고 월별로 집계: [0.1, 0.2, 0.3, 0.4] 가중치 활용
◦ 전체 sMSE(standardized mean squared error), sMAE(standardized mean absolute error)값(총 21개)의 평균으로 성능 평가
◦ 매 시점(time step)마다 최신 데이터를 반영(전체 가중치 재학습은 시행 X), 예측 모델 업데이트 및 예측 실행

□ 단기예측 실험 결과

□ 장기예측 실험 구성
◦ 2024년 11월 첫째 주를 기준으로 4주, 8주, 12주, ..., 40주(최대 10개월) 후 예측을 수행하여 예측 기간에 따른 모델 성능 변화를 비교
◦ 하나의 모델을 최대 예측 기간(40주)에 맞춰 학습한 후, 동일한 모델을 사용하여 다양한 horizon(4주, 8주, 12주, ..., 40주)에 대한 예측을 수행
◦ 단기 예측 실험과 마찬가지로 월별 데이터를 기준으로 평가 지표 계산
◦ 재귀적 예측과 달리 최신 데이터를 반영하는 모델 업데이트는 처음 한번만 실행
